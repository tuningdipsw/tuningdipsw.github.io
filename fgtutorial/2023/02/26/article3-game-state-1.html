<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Let's make a fighting game #3: Game state (1)</title>
	<link rel="stylesheet" href="/assets/css/styles.css">
	<link type="application/atom+xml" rel="alternate" href="https://tuningdipsw.github.io/pages/tuningdipsw/feed.xml" title="Home of one of the Hellsinker. players of all time" />
	<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Let’s make a fighting game #3: Game state (1) | Home of one of the Hellsinker. players of all time</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Let’s make a fighting game #3: Game state (1)" />
<meta name="author" content="minogame" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="« Prev: #2: Inputs « Prev: #2.1: Unit testing examples Good day. In this series of articles, I’ll be attempting to program a simple 2D fighting game using the Python game development library Pygame. We’ve created a system to translate key presses into logical buttons, but they don’t do anything yet; we have no concept of an action, nor even a concept of a character with which to perform one. Let’s start getting that set up." />
<meta property="og:description" content="« Prev: #2: Inputs « Prev: #2.1: Unit testing examples Good day. In this series of articles, I’ll be attempting to program a simple 2D fighting game using the Python game development library Pygame. We’ve created a system to translate key presses into logical buttons, but they don’t do anything yet; we have no concept of an action, nor even a concept of a character with which to perform one. Let’s start getting that set up." />
<link rel="canonical" href="https://tuningdipsw.github.io/pages/tuningdipsw/fgtutorial/2023/02/26/article3-game-state-1.html" />
<meta property="og:url" content="https://tuningdipsw.github.io/pages/tuningdipsw/fgtutorial/2023/02/26/article3-game-state-1.html" />
<meta property="og:site_name" content="Home of one of the Hellsinker. players of all time" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-26T14:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Let’s make a fighting game #3: Game state (1)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"minogame"},"dateModified":"2023-02-26T14:00:00+00:00","datePublished":"2023-02-26T14:00:00+00:00","description":"« Prev: #2: Inputs « Prev: #2.1: Unit testing examples Good day. In this series of articles, I’ll be attempting to program a simple 2D fighting game using the Python game development library Pygame. We’ve created a system to translate key presses into logical buttons, but they don’t do anything yet; we have no concept of an action, nor even a concept of a character with which to perform one. Let’s start getting that set up.","headline":"Let’s make a fighting game #3: Game state (1)","mainEntityOfPage":{"@type":"WebPage","@id":"https://tuningdipsw.github.io/pages/tuningdipsw/fgtutorial/2023/02/26/article3-game-state-1.html"},"url":"https://tuningdipsw.github.io/pages/tuningdipsw/fgtutorial/2023/02/26/article3-game-state-1.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>
	<div class="page sidebar">
    <nav class="top">
<table>
<tr>
  
  <td>
    <a href="/" >
      Home
    </a>
  <td class="gap">
  
  <td>
    <a href="/about/" >
      About
    </a>
  <td class="gap">
  
  <td>
    <a href="/table-of-contents.html" >
      Contents
    </a>
  <td class="gap">
  
  <td>
    <a href="/staff.html" >
      Author
    </a>
  <td class="gap">
  
</tr>
</table
</nav>

    <h1 class="pagetitle">TUNINGDIPSW</h1>
	<h4>Instructional website for a fighting game developer</h4>
	<h2> Let's make a fighting game #3: Game state (1) </h2>
	<div class="content">
    <p>
  26 Feb 2023
  
  
    - <a href="/authors/tuningdipsw.html">TUNING DIPSW (Andrew Hsu)</a>
  
</p>

<div id="table-of-contents">
  <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#eventual-goals">Eventual goals</a>
<ul>
<li class="toc-entry toc-h3"><a href="#implement-saveable-loadable-state-as-required-by-rollback">Implement saveable, loadable state, as required by rollback.</a></li>
<li class="toc-entry toc-h3"><a href="#define-characters-and-their-attacks-in-terms-of-hitboxes-and-hurtboxes">Define characters and their attacks in terms of hitboxes and hurtboxes.</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#what-is-a-statetimeline">(What is a StateTimeline?)</a></li>
<li class="toc-entry toc-h2"><a href="#more-eventual-goals">More eventual goals</a>
<ul>
<li class="toc-entry toc-h3"><a href="#store-and-handle-character-data-with-a-scalable-workflow">Store and handle character data with a scalable workflow.</a></li>
<li class="toc-entry toc-h3"><a href="#find-or-write-a-useful-tool-for-generating-hitbox-and-hurtbox-information">Find or write a useful tool for generating hitbox and hurtbox information.</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#simple-game-state-drawing-and-movement">Simple game state, drawing, and movement</a>
<ul>
<li class="toc-entry toc-h3"><a href="#knowledge-couplings">Knowledge couplings</a></li>
<li class="toc-entry toc-h3"><a href="#walking">Walking</a></li>
<li class="toc-entry toc-h3"><a href="#characterfacingleft">character.facingLeft</a></li>
<li class="toc-entry toc-h3"><a href="#rendering-ui">Rendering UI</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#stopping-point">Stopping point</a></li>
<li class="toc-entry toc-h2"><a href="#aside-when-or-when-not-to-flip-a-character">Aside: When or when not to flip a Character</a></li>
</ul> 
</div>

<p><a href="/fgtutorial/2023/02/06/article2-inputs.html">« Prev: #2: Inputs</a></p>

<p><a href="/fgtutorial/2023/02/12/article2-1-unit-testing-examples.html">« Prev: #2.1: Unit testing examples</a></p>

<p>Good day. In this series of articles, I’ll be attempting to program a simple 2D
fighting game using the Python game development library Pygame.</p>

<p>We’ve created a system to translate key presses into logical buttons,
but they don’t <em>do</em> anything yet; we have no concept of an action,
nor even a concept of a character with which to perform one.</p>

<p>Let’s start getting that set up.</p>

<!--more-->

<h2 id="eventual-goals">Eventual goals</h2>

<p>In addition to the holdover goals of “parsing inputs into actions”
and “accept buffered inputs” from article #2, we can add a few more goals
around our game state.</p>

<p>The goals for our input system were easier to scope down by comparison, but,
well, the game state sort of encompasses everything a fighting game is –
the rules and numbers for everything that you CAN do, so I am at risk of just writing</p>

<p>“Make a fighting game.”</p>

<p>here and dusting my hands off, walking away, leaving everyone baffled.</p>

<p>But, instead, I will do my best to spell out how each bit of game state we define will turn
our game into the fighting game we’re all familiar with.</p>

<h3 id="implement-saveable-loadable-state-as-required-by-rollback"><strong>Implement saveable, loadable state, as required by rollback.</strong></h3>

<p>The task of serializing things, making saves of our state, and setting our state to that of a saved state
isn’t actually a very complicated or difficult problem for us to solve in Pygame,
but I’ll write this down anyways.</p>

<h3 id="define-characters-and-their-attacks-in-terms-of-hitboxes-and-hurtboxes"><strong>Define characters and their attacks in terms of hitboxes and hurtboxes.</strong></h3>

<p>Near all that a fighting game is, is defined by hitboxes, hurtboxes, and frame data.</p>

<blockquote>
  <p>For a recap on hitboxes and hurtboxes, consult Dustloop’s <a href="https://www.dustloop.com/w/Hitboxes">hitboxes article</a>.</p>
</blockquote>

<p>If your attack hitbox collides with the opponent’s character hurtbox,
you apply the hit, and you reduce the opponent’s HP.</p>

<p>Doesn’t sound so complicated, right?<br />
You could say this simple principle of collision detection holds of many other games, such as Pong, or Space Invaders.</p>

<p>But the fine nuance of interaction in a fighting game lies in the third dimension of time.<br />
In order to codify the frames (unit of time) of the frame data into our game,
we need a particular object called a StateTimeline.</p>

<aside>
Disclosure: I didn't have a full understanding of
how to handle state, animations, and time until I read through Zinac's
<a href="https://github.com/rcmagic/DemoFighterWithNetcode/blob/master/game/StateTimelines.lua">
DemoFighter,
</a>
from which I am taking the term "state timeline" from.
I draw upon his open-source work with respect and gratitude.
</aside>

<h2 id="what-is-a-statetimeline">(What is a StateTimeline?)</h2>

<p><a href="https://github.com/rcmagic/DemoFighterWithNetcode/blob/master/game/StateTimelines.lua">In short, it’s what this code represents.</a><br />
If you were able to get a sense for what that object was used for, feel free to skim through the following section.<br />
But, for completeness, allow me to explain in excruciating detail.</p>

<p>A fighting game allows its characters to perform a great variety of actions to choose from,
a tremendous offering of all sorts of attacks and movement.
In comparison, a game like a shmup offers the player only elementary actions.</p>

<p>But the difference lies in <em>commitment</em> -
the limitations on what actions a character can take while they’re performing another one.</p>

<p>For example, a shmup requires the player maintain fine control of their ship at all times -
though the player is only offered two axes of movement, a shot button, and perhaps a bomb button,
they’re given great control over the granularity of how much or how little they want to move, fire, or bomb.<br />
Not only that, all these systems can be operated simultaneously.<br />
In general, high-commitment actions in STGs are quite rare, and the relative loss of fine control feels extremely wrong.</p>

<p>Meanwhile, almost <em>every</em> action in a fighting game has some degree of commitment attached to it.</p>

<p><img src="/assets/images/article3/pot-5h-frame-data.png" alt="+R Potemkin 5H from Dustloop" />
<em>Example data of a fighting game attack, from <a href="https://www.dustloop.com/w/GGACR/Potemkin#5H">Dustloop.</a></em></p>

<p>Every attack can be divided into startup, active, and recovery frames,
and for the most part, you only get to “cancel” your attack into something else after it’s hit something.</p>

<p>So the startup frames are already a commitment - only when your attack comes into contact with your opponent
(active frames) are you allowed to take any possible cancel options (for some defined “cancel window”).<br />
You are not free to perform <em>any</em> action afterward, either -
you only have a choice from a limited list of valid cancel options,
else you’ll have to wait out the rest of your recovery frames like normal.</p>

<p><img src="/assets/images/article3/strive%20gatling%20table%20-%20NBSilentShadow%20-%20status%201404937791889416193.jpg" alt="Strive gatling chart" /></p>

<p><em>Chart of Strive’s valid “gatling” cancels for each attack.</em>
<em>You don’t need to memorize this for this article.</em>
<em><a href="https://twitter.com/NBSilentShadow/status/1404937791889416193">(Source)</a></em></p>

<aside>
These are general rules - there are edge cases where a whiffed move's recovery
or a move's startup can be canceled (see
<a href="https://glossary.infil.net/?t=Purple%20Roman%20Cancel">Strive PRC</a> and
<a href="https://glossary.infil.net/?t=Kara%20Cancel">kara cancelling</a>).
</aside>

<p>And, if the attack never comes into contact with the opponent, or “whiffs”,
you’ll be unable to take any action at all until the end of the recovery frames.</p>

<p>And, of course, there are some times when your character can’t perform any actions at all,
like when you’re in hitstun, blockstun, or have been knocked down.</p>

<p>So in comparison to the shmup, where you can just do pretty much anything at any time,
the limitations on which actions can be taken at which times lends itself well to
modelling our fighting game with states.</p>

<p>That’s the “state” part of “state timeline” -
so, as you might expect, the “timeline” captures the dimension of time.</p>

<p>For each state we have in mind, be it a dash, an idle stance, or an attack,
each with their own hitbox and hurtbox dimensions,
animation sprites,
and cancel options,
we also attach the timelines, or the timings, for each property.</p>

<ul>
  <li>When do the hitboxes first appear?</li>
  <li>Do they change in shape on a later frame?</li>
  <li>Do the hurtboxes change over the course of the state?</li>
  <li>Every state has its own animation, of course -
which sprite images appear at which times of the state, and for how long?</li>
  <li>Perhaps the attack causes the character to move around as well, like a teleport or a transport attack -
when does the movement begin? How much does it accelerate the character by?</li>
</ul>

<p>The StateTimeline is an object that captures both the properties and the timings of a state.
Without it, our fighting game character can’t even perform an attack.</p>

<p>With those properties explained, DemoFighter’s simple
<a href="https://github.com/rcmagic/DemoFighterWithNetcode/blob/master/game/StateTimelines.lua">StateTimeline</a>
should hopefully make a lot more sense to you.<br />
Note that DemoFighter only implements two states as timelines: an attack state and an idle state.
Cancel options aren’t included in their model – we’ll have to work that into our own implementation of the object.</p>

<h2 id="more-eventual-goals">More eventual goals</h2>

<h3 id="store-and-handle-character-data-with-a-scalable-workflow"><strong>Store and handle character data with a scalable workflow.</strong></h3>

<p>Almost all games are really just composed of a lot of numbers,
and despite them looking like they’re just about two characters punching each other,
fighting games are no exception.</p>

<p>Those timelines we showed off earlier are almost all composed of numbers,
so we can expect to have to manage quite a few of them.
Here’s an example of just a <a href="https://www.dustloop.com/w/GGACR/Potemkin/Frame_Data">single character’s frame data.</a>
As you can see, there are quite a few numbers there.</p>

<p>So you’ll have to come up with a way to manage all those numbers in a way
that’s easy to read, easy to update, and easy to generate.<br />
Writing those numbers into your code directly will not do you any favours.<br />
Hunting for a particular value will be difficult,
and the file probably won’t be set up so that you can easily compare one value to another by eye.</p>

<p>Spreadsheet software handles numbers wonderfully.<br />
Masahiro Sakurai (of Super Smash Bros. directing fame) talks a bit about this
in his video about <a href="https://www.youtube.com/watch?v=nGaajB8m5Q0">setting up parameters</a>.</p>

<p><a href="https://www.youtube.com/watch?v=nGaajB8m5Q0"><img src="/assets/images/article3/sakurai-on-parameters.png" alt="Image link to Sakurai's video" /></a></p>

<p>If we want to wrangle large amounts of data, we need a good tooling workflow.</p>

<p>Our plan is to:</p>
<ol>
  <li>Store our character data and frame data in a spreadsheet that we can easily manipulate.</li>
  <li>Export and convert that into a format that our Python game can read (StateTimelines).</li>
  <li>Have our game use those StateTimelines to give our attacks the desired properties.</li>
</ol>

<h3 id="find-or-write-a-useful-tool-for-generating-hitbox-and-hurtbox-information"><strong>Find or write a useful tool for generating hitbox and hurtbox information.</strong></h3>

<p>Having a spreadsheet will be useful, but there’s another wrinkle in our workflow we’ll have to smooth out.</p>

<p>If this game is just a proof of concept for our tutorial, it’s okay, and feasible, for us to
write exactly one attack and lay down a few numbers to define the
dimensions of each hitbox and hurtbox associated with it.</p>

<p>However, as soon as we start wanting our game to have <em>plural numbers of attacks</em>,
we will soon come to realize that attempting to define our character timelines by hand,
through manual data entry, is extremely painful.<br />
Even though Zinac’s DemoFighter really only has an idle state and one attack,
you can still see how he had to write a whole bunch of strange magic numbers into
<a href="https://github.com/rcmagic/DemoFighterWithNetcode/blob/master/game/StateTimelines.lua">his data file</a>
to define character hit/hurtboxes.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># StateTimelines.lua
# ...
</span>    <span class="n">damageBoxes</span> <span class="o">=</span> 
    <span class="p">{</span>
        <span class="p">{</span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="mi">26</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">}</span>
    <span class="p">},</span>

    <span class="n">attackBoxes</span> <span class="o">=</span> 
    <span class="p">{</span>
        <span class="p">{</span><span class="n">start</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">120</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span><span class="p">}</span>
    <span class="p">},</span>
</code></pre></div></div>

<p>If you go over to <a href="https://www.spriters-resource.com/pc_computer/blazbluecentralfiction/sheet/108864/">Spriter’s Resource</a>
and download (eg.) Azrael from <em>BlazBlue Centralfiction</em>’s sprites, you can “borrow” all the sprite images you want -</p>

<p>But you’ll notice that the dimensions of each sprite aren’t consistent:</p>

<p><img src="/assets/images/article3/az202_04.png" alt="" /></p>

<p><img src="/assets/images/article3/az202_05.png" alt="" /></p>

<p><em>Two consecutive frames of Azrael’s 5C attack.</em></p>

<p>So, where should the anchor point of our game state x- and y-coordinates be, relative to this sprite?<br />
And where should the hit-and-hurtboxes of this attack be, relative to our x,y-coords?<br />
– Measuring which pixel should go where to define all those numbers is not practical.</p>

<p>It’s not intuitive for humans to convert between raw positional numbers and images in their heads.
<strong>I will not be calculating and entering 5,000 numbers by hand</strong>, and I hope you will not be either.</p>

<p>I want to use a tool where I just click or drag boxes on my sprite image, and it prints out the Rect data for what I just did.
I do that a couple of times for the however many frames of my attack animation, and I have the h-boxes of my timeline.</p>

<p>Can we find an existing tool?<br />
Hmm. The MUGEN enthusiasts have to work with sprites all the time,
I imagine they’ve got to have a tool they use to define their hitboxes.</p>

<p>A search for MUGEN hitboxes led me to the
<a href="https://mugenguild.com/forum/topics/the-importance-hitboxeshurtboxes-and-why-they-matter-193823.0.html">MUGEN Fighters Guild forums</a>,
which mentioned the term CLSN. (Collision?)
That term led me to <a href="https://www.youtube.com/watch?v=EDDIKSgXayw">this tutorial</a> for defining CLSN boxes
in a tool called <a href="http://fighterfactory.virtualltek.com/">Fighter Factory 3</a>.</p>

<p>So we may wish to give this tool a try.
I will experiment with this when we start to move from a proof of concept into a scaled-up fighting game.
If it’s something we can incorporate into our workflow, awesome.<br />
If not, then we’ll probably just have to make one ourselves.<br />
But we may still be able to draw some inspiration from this tool in terms of usability,
so we should still give it a try.</p>

<h2 id="simple-game-state-drawing-and-movement">Simple game state, drawing, and movement</h2>

<p>With our larger goals in mind, let’s start making changes to our code.</p>

<aside>
* Q: Is this the post-edited version of the code? <br />
A: ...
</aside>

<p>Ok, prescient disclaimer from the future here - we have a lot of stuff to put together ahead of us,
and it’s not always going to be obvious, or even apparent, what the best way to write it is, until we write it.<br />
So to prevent ourselves from going into a catatonic state of indecision from not knowing how to do it best,
we’re going to hack together some atrocious first-pass code,
giving ourselves something to work with that vaguely does what we want,
and then we’re going to delete 50% of it in post.*</p>

<p>So don’t scream if you see some really ugly functions in the next 20 minutes,
just tell yourself the author’s going to fix that in the future, like I’m doing right now,
and the fear and revulsion should subside.</p>

<p>Let’s make a GameState class to store our game state properties.
Off the top of my head, we’ll put the round timer and the two characters’ states in there.<br />
Let’s also move the <code class="language-plaintext highlighter-rouge">current_frame</code> variable we had lying around in <code class="language-plaintext highlighter-rouge">main.py</code> into there as well.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># gamestate.py
</span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">import</span> <span class="nn">pygame</span> <span class="k">as</span> <span class="n">pg</span>

<span class="kn">import</span> <span class="nn">constants</span>
<span class="kn">import</span> <span class="nn">inputs</span>
<span class="kn">from</span> <span class="nn">inputs</span> <span class="kn">import</span> <span class="n">Button</span>

<span class="k">class</span> <span class="nc">GameState</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputHistories</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">inputs</span><span class="p">.</span><span class="n">InputHistory</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">current_frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">inputHistories</span> <span class="o">=</span> <span class="n">inputHistories</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Character</span><span class="p">]</span><span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">[</span><span class="s">"P1"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Character</span><span class="p">(</span><span class="n">inputHistories</span><span class="p">[</span><span class="s">"P1"</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s">"P1"</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">[</span><span class="s">"P2"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Character</span><span class="p">(</span><span class="n">inputHistories</span><span class="p">[</span><span class="s">"P2"</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s">"P2"</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">character</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">current_frame</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="p">.</span><span class="n">current_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">current_frame</span> <span class="o">+</span> <span class="mi">1</span>
        
    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">display</span><span class="p">:</span> <span class="n">pg</span><span class="p">.</span><span class="n">surface</span><span class="p">.</span><span class="n">Surface</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># render characters
</span>        <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">character</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">display</span><span class="p">)</span>
</code></pre></div></div>

<p>And let’s add the Character class underneath it:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># gamestate.py
# ...
</span><span class="k">class</span> <span class="nc">Character</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputHistory</span><span class="p">:</span> <span class="n">inputs</span><span class="p">.</span><span class="n">InputHistory</span><span class="p">,</span> \
                 <span class="n">gameState</span><span class="p">:</span> <span class="n">GameState</span><span class="p">,</span> <span class="n">player</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Pass in references to other systems Character needs to know about
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">inputHistory</span> <span class="o">=</span> <span class="n">inputHistory</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">gameState</span> <span class="o">=</span> <span class="n">gameState</span>
        
        <span class="k">if</span> <span class="n">player</span> <span class="o">==</span> <span class="s">"P1"</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># P2
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">constants</span><span class="p">.</span><span class="n">WINDOW_WIDTH</span> <span class="o">-</span> <span class="mi">50</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">ypos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">constants</span><span class="p">.</span><span class="n">WINDOW_HEIGHT</span> <span class="o">-</span> <span class="mi">50</span>
        
        <span class="c1"># TODO: probably want a special load_character helper
</span>        <span class="c1"># for loading char's sprites en masse
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">surface</span><span class="p">:</span> <span class="n">pg</span><span class="p">.</span><span class="n">Surface</span> <span class="o">=</span> <span class="n">pg</span><span class="p">.</span><span class="n">image</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">'assets/guy2.png'</span><span class="p">).</span><span class="n">convert_alpha</span><span class="p">()</span>
        
        <span class="c1"># TODO: arbitrary placeholder values,
</span>        <span class="c1"># would like to load this in from a character data file
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">maxHp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">hp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">maxHp</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">walkspeed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">facingLeft</span> <span class="o">=</span> <span class="bp">False</span>
        
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="s">'''
        Takes a frame_number, and updates self based on the Buttons pressed on that frame.
        '''</span>
        <span class="c1"># NOTE: Added a helper function in inputs.py to get the buttons dict for frame X
</span>        <span class="n">frame_buttons</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">inputHistory</span><span class="p">.</span><span class="n">getFrameButtons</span><span class="p">(</span><span class="n">frame_number</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">frame_buttons</span><span class="p">[</span><span class="n">Button</span><span class="p">.</span><span class="n">LEFT</span><span class="p">]:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">walkspeed</span>
        <span class="k">elif</span> <span class="n">frame_buttons</span><span class="p">[</span><span class="n">Button</span><span class="p">.</span><span class="n">RIGHT</span><span class="p">]:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">walkspeed</span>
        
        <span class="c1"># Limits on xpos
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">WINDOW_WIDTH</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">xpos</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">display</span><span class="p">:</span> <span class="n">pg</span><span class="p">.</span><span class="n">surface</span><span class="p">.</span><span class="n">Surface</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div></div>

<p>We’ve added a very simple <code class="language-plaintext highlighter-rouge">update()</code> function that uses our <code class="language-plaintext highlighter-rouge">inputHistory</code> to move our <code class="language-plaintext highlighter-rouge">Character</code>s left and right.</p>

<p>You might notice that there’s not actually very much game state that exists outside of the <code class="language-plaintext highlighter-rouge">Character</code>s
(ie. exists only in <code class="language-plaintext highlighter-rouge">GameState</code>) apart from the round timer.</p>

<p>We could choose to put <code class="language-plaintext highlighter-rouge">Character</code>-created objects (ie. projectiles like fireballs)
in <code class="language-plaintext highlighter-rouge">GameState</code>, but it might make more sense to attach them to the <code class="language-plaintext highlighter-rouge">Character</code> class instead,
to make their ownership clearer.</p>

<aside>
Although stage aesthetic can sometimes indirectly affect gameplay by making some attacks
harder to see, eg.
<a href="https://streetfighter.fandom.com/wiki/Kanzuki_Beach#Trivia">Kanzuki Beach</a>'s
waves obscuring certain character projectiles.
</aside>

<blockquote>
  <p>The stage itself might have some relevant state -
although it’s more common in traditional fighters that the stage itself has no direct impact on gameplay,
some games like Smash Bros or Injustice feature <a href="https://youtu.be/ZTeFLQlS6EI?t=195">stage interactables</a>.<br />
That state should go in a separate Stage class within <code class="language-plaintext highlighter-rouge">GameState</code>, to mark it as one of our rollbackable objects.</p>

  <p>If our stage is purely aesthetic, though, it’s not part of the game state that needs to be saved as part of rollback,
so we could choose to put that off to some outside class that only touches our main.py render() loop.</p>
</blockquote>

<p>We do need to render <em>something</em> on our window just so we have some feedback
to see how <code class="language-plaintext highlighter-rouge">update()</code> is working.<br />
This calls for art.</p>

<p><img src="/assets/images/article3/guy.png" alt="Guy sprite 1" /></p>

<p>Perfect.</p>

<p>…</p>

<p><img src="/assets/images/article3/guy2.png" alt="Guy sprite 2" /></p>

<p>Perfect.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># gamestate.py
# ...
</span><span class="k">class</span> <span class="nc">Character</span><span class="p">():</span>
    <span class="c1"># ...
</span>    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">display</span><span class="p">:</span> <span class="n">pg</span><span class="p">.</span><span class="n">surface</span><span class="p">.</span><span class="n">Surface</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">pg</span><span class="p">.</span><span class="n">Rect</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">surface</span><span class="p">.</span><span class="n">get_rect</span><span class="p">())</span>
        <span class="n">rect</span><span class="p">.</span><span class="n">midbottom</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">xpos</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">ypos</span><span class="p">)</span>
        
        <span class="n">surface_facing</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">surface</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">facingLeft</span><span class="p">:</span>
            <span class="n">surface_facing</span> <span class="o">=</span> <span class="n">pg</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">flip</span><span class="p">(</span><span class="n">surface_facing</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

        <span class="n">display</span><span class="p">.</span><span class="n">blit</span><span class="p">(</span><span class="n">surface_facing</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
</code></pre></div></div>

<p>With some simple rendering code, we get something like this:</p>

<p><img src="/assets/images/article3/render-guys-1.gif" alt="The first moving guys" /></p>

<blockquote>
  <p>NB: <code class="language-plaintext highlighter-rouge">rect.midbottom = (self.xpos, self.ypos)</code>
is a neat trick to align the middle of the sprite image’s bottom edge to (xpos,ypos).<br />
For now, this is okay, but as we discussed above, the anchor point of most of our sprites won’t be so consistent.<br />
We’ll need to modify this logic in the future.</p>
</blockquote>

<aside>
Disclosure: A slight adjustment to our input system was made to support 2 players properly between articles.
It was simple enough that I feel confident leaving it as an exercise to the reader.
Alternatively, check `inputs.py` in the code repository.
</aside>

<h3 id="knowledge-couplings">Knowledge couplings</h3>

<p>Let’s take a moment to look at some of the couplings we’re planning with our classes.
We don’t necessarily need to torment ourselves over this prematurely,
but it also doesn’t hurt to take a step back from time to time
and see if we’ll write, or even, we’ve written, ourselves into a maintenance swamp.</p>

<p><strong>InputHistory does not need to know anything about GameState.</strong>
Great! That’s what we set out to do at first, and that hasn’t changed.</p>

<p><strong>Character (an object stored within GameState) needs to know about its player’s InputHistory, but not the other player’s.</strong>
That’s what we expected.</p>

<p><strong>Character needs to know about the opponent’s Character.</strong>
This is necessary in order to determine:</p>
<ul>
  <li>whether to “turn around”/flip its sprites</li>
  <li>whether relative direction “back” is left or right</li>
  <li>whether opponent is low enough HP to (eg.) perform an <a href="https://glossary.infil.net/?t=Astral%20Heat">Astral Finish</a></li>
</ul>

<p><strong>Character may need to know some GameState information.</strong>
For most applications, you probably won’t need this, but there <em>are</em> a few edge cases where you could use GameState:</p>
<ul>
  <li>for stage interactables</li>
  <li>for the <a href="https://www.dustloop.com/w/GGACR/Zappa#Hello,_Three_Centipedes">rare move influenced by round timer</a></li>
</ul>

<p>Neat-o. The couplings seem manageable, perhaps even expected, so we’ll put up with them for the time being.<br />
<code class="language-plaintext highlighter-rouge">GameState</code> has access to the pair of inputHistories when it’s created in <code class="language-plaintext highlighter-rouge">main.py</code>,
and we can pass inputHistory and gameState into <code class="language-plaintext highlighter-rouge">Character.__init__()</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># gamestate.py
</span><span class="k">class</span> <span class="nc">GameState</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputHistories</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">inputs</span><span class="p">.</span><span class="n">InputHistory</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">inputHistories</span> <span class="o">=</span> <span class="n">inputHistories</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Character</span><span class="p">]</span><span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">[</span><span class="s">"P1"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Character</span><span class="p">(</span><span class="n">inputHistories</span><span class="p">[</span><span class="s">"P1"</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s">"P1"</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">[</span><span class="s">"P2"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Character</span><span class="p">(</span><span class="n">inputHistories</span><span class="p">[</span><span class="s">"P2"</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s">"P2"</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">[</span><span class="s">"P1"</span><span class="p">].</span><span class="n">assignOpponent</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">[</span><span class="s">"P2"</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">[</span><span class="s">"P2"</span><span class="p">].</span><span class="n">assignOpponent</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">[</span><span class="s">"P1"</span><span class="p">])</span>   
<span class="c1"># ...
</span>
<span class="k">class</span> <span class="nc">Character</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputHistory</span><span class="p">:</span> <span class="n">inputs</span><span class="p">.</span><span class="n">InputHistory</span><span class="p">,</span> \
                <span class="n">gameState</span><span class="p">:</span> <span class="n">GameState</span><span class="p">,</span> <span class="n">player</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">inputHistory</span> <span class="o">=</span> <span class="n">inputHistory</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">gameState</span> <span class="o">=</span> <span class="n">gameState</span>
        <span class="k">if</span> <span class="n">player</span> <span class="o">==</span> <span class="s">"P1"</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># P2
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">constants</span><span class="p">.</span><span class="n">WINDOW_WIDTH</span> <span class="o">-</span> <span class="mi">50</span>
        
<span class="c1"># ...
</span></code></pre></div></div>

<p>To make getting the opposing Character’s attributes a little easier to type,
we <em>do</em> do something slightly irresponsible:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Character</span><span class="p">():</span>
    <span class="c1"># ...
</span>    <span class="k">def</span> <span class="nf">assignOpponent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">opponent</span><span class="p">:</span> <span class="n">Character</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="s">'''
        Part of initialization, but deferred until after both Characters have been created
        to prevent P1 from referring to P2 before P2 has been created.
        '''</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">opponent</span> <span class="o">=</span> <span class="n">opponent</span>
</code></pre></div></div>

<p>Note that this is technically poor practice in Class design, because if <code class="language-plaintext highlighter-rouge">Character</code> gets used in the future by some other library,
it is possible for them to create a valid <code class="language-plaintext highlighter-rouge">Character</code> without remembering to call <code class="language-plaintext highlighter-rouge">assignOpponent</code> afterward, causing errors.
It would be best if this could automatically be handled in initialization.
But since we don’t expect the <code class="language-plaintext highlighter-rouge">Character</code> class to be passed around much,
only within <code class="language-plaintext highlighter-rouge">gamestate.py</code> and its tests, we’ll ease up a little here.</p>

<h3 id="walking">Walking</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># gamestate.py, Character()
</span><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="s">'''
    Takes a frame_number, and updates self based on the Buttons pressed on that frame.
    '''</span>
    <span class="c1"># NOTE: Added a helper function in inputs.py to get the buttons dict for frame X
</span>    <span class="n">frame_buttons</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">inputHistory</span><span class="p">.</span><span class="n">getFrameButtons</span><span class="p">(</span><span class="n">frame_number</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">frame_buttons</span><span class="p">[</span><span class="n">Button</span><span class="p">.</span><span class="n">LEFT</span><span class="p">]:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">walkspeed</span>
    <span class="k">elif</span> <span class="n">frame_buttons</span><span class="p">[</span><span class="n">Button</span><span class="p">.</span><span class="n">RIGHT</span><span class="p">]:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">walkspeed</span>
</code></pre></div></div>

<p>We dumped our movement code above into <code class="language-plaintext highlighter-rouge">Character.update()</code> in a very straightforward way,
but it would be nice if we could move that into its own function.
Not only will it make <code class="language-plaintext highlighter-rouge">update()</code> a little cleaner, it will be easier to write tests for if it has its own function.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># gamestate.py, Character()
</span><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="s">'''
    Takes a frame_number, and updates self based on the Buttons pressed on that frame.
    '''</span>
    <span class="n">frame_buttons</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">inputHistory</span><span class="p">.</span><span class="n">getFrameButtons</span><span class="p">(</span><span class="n">frame_number</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">frame_buttons</span><span class="p">[</span><span class="n">Button</span><span class="p">.</span><span class="n">LEFT</span><span class="p">]</span> <span class="ow">or</span> <span class="n">frame_buttons</span><span class="p">[</span><span class="n">Button</span><span class="p">.</span><span class="n">RIGHT</span><span class="p">]):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="n">frame_buttons</span><span class="p">)</span>
    <span class="c1"># ...
</span>
<span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buttons</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Button</span><span class="p">,</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">facingLeft</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">buttons</span><span class="p">[</span><span class="n">Button</span><span class="p">.</span><span class="n">LEFT</span><span class="p">]:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">forwardWalkspeed</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">backwardWalkspeed</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">buttons</span><span class="p">[</span><span class="n">Button</span><span class="p">.</span><span class="n">LEFT</span><span class="p">]:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">backwardWalkspeed</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">forwardWalkspeed</span>
</code></pre></div></div>

<p>I’m not sure how common it is for forward and backwards walk speeds to be
<a href="https://hisouten.koumakan.jp/wiki/Movement_Data#Walking">different</a>,
but I decided to throw it in here for fun.<br />
To my knowledge, they’re usually made the same, but my understanding is that they have slightly uses in gameplay -<br />
High backwalk speed helps you make your opponent’s attacks whiff,
while high forward walk speed helps you ensure your attacks don’t.</p>

<p>If you wanted to make a character good at one of these but not the other,
you might choose to give them different walkspeeds.</p>

<h3 id="characterfacingleft">character.facingLeft</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># gamestate.py
</span><span class="k">class</span> <span class="nc">Character</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputHistory</span><span class="p">:</span> <span class="n">inputs</span><span class="p">.</span><span class="n">InputHistory</span><span class="p">,</span> <span class="n">gameState</span><span class="p">:</span> <span class="n">GameState</span><span class="p">,</span> \
                 <span class="n">player</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># ...
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">facingLeft</span> <span class="o">=</span> <span class="bp">False</span>
</code></pre></div></div>

<p>We haven’t done anything with it yet, but we did define the <code class="language-plaintext highlighter-rouge">Character</code> property <code class="language-plaintext highlighter-rouge">facingLeft</code>
to determine whether to flip our <code class="language-plaintext highlighter-rouge">Character</code>.
It’
s actually a very pertinent part of state, not just a visual marker that flips our sprite horizontally.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># gamestate.py
</span><span class="k">class</span> <span class="nc">Character</span><span class="p">():</span>
    <span class="c1"># ...
</span>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># ...
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">faceOpponent</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">isRightOfOpponent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s">'''
        Note that the blocking direction check uses this directly,
        but general input flip (forward vs back), sprite flip, hit/hurtbox flip
        are determined by self.facingLeft instead,
        a value that isn't always updated every frame.
        '''</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="p">.</span><span class="n">opponent</span><span class="p">.</span><span class="n">xpos</span>
    
    <span class="k">def</span> <span class="nf">faceOpponent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="s">'''
        Sets self.facingLeft based on Character's position relative to opponent Character.
        '''</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">facingLeft</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">isRightOfOpponent</span><span class="p">()</span>
</code></pre></div></div>

<p>For now, we just make each <code class="language-plaintext highlighter-rouge">Character</code> face their opponent on every frame,
but our desired logic is a little bit more complex. (See the end of chapter of aside for more information.)</p>

<h3 id="rendering-ui">Rendering UI</h3>

<p>Let’s add our first UI elements to our game, HP bars and a round timer.</p>

<p>Although the HP bars reference an attribute that belongs to the <code class="language-plaintext highlighter-rouge">Character</code>s,
I think of <code class="language-plaintext highlighter-rouge">Character.render()</code> as the function that renders the <code class="language-plaintext highlighter-rouge">Character</code> sprite, and the sprite only.
So I feel that we should put our UI rendering in <code class="language-plaintext highlighter-rouge">GameState.render()</code> instead.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># gamestate.py
</span><span class="k">class</span> <span class="nc">GameState</span><span class="p">():</span>
    <span class="c1"># ...
</span>    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">display</span><span class="p">:</span> <span class="n">pg</span><span class="p">.</span><span class="n">surface</span><span class="p">.</span><span class="n">Surface</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># render UI
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">renderRoundTimer</span><span class="p">(</span><span class="n">display</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">renderHpBars</span><span class="p">(</span><span class="n">display</span><span class="p">)</span>
        
        <span class="c1"># render characters
</span>        <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">character</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">display</span><span class="p">)</span>
</code></pre></div></div>

<p>Our round timer update logic will be a little basic, but it’ll get the job done for now.
With a bit of Rect finagling, we can easily put it on the top of the screen.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># TODO: may add more nuance to round timer than this
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">round_timer</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">round_timer</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">constants</span><span class="p">.</span><span class="n">FRAME_RATE_CAP</span>
        <span class="c1"># ...
</span>
    <span class="k">def</span> <span class="nf">renderRoundTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">display</span><span class="p">:</span> <span class="n">pg</span><span class="p">.</span><span class="n">surface</span><span class="p">.</span><span class="n">Surface</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="s">'''
        Basic font-based method of rendering the round timer.
        '''</span>
        <span class="n">rounded_timer</span> <span class="o">=</span> <span class="s">"{:.0f}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">round_timer</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">rounded_timer</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">constants</span><span class="p">.</span><span class="n">WHITE</span><span class="p">)</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">get_rect</span><span class="p">()</span>
        <span class="n">rect</span><span class="p">.</span><span class="n">midtop</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">WINDOW_WIDTH</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">display</span><span class="p">.</span><span class="n">blit</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
</code></pre></div></div>

<p>HP bars aren’t too difficult either. We’ll draw a coloured, “full” rectangle of varying length
on top of a white, “empty” rectangle of static length.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">def</span> <span class="nf">renderHpBars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">display</span><span class="p">:</span> <span class="n">pg</span><span class="p">.</span><span class="n">surface</span><span class="p">.</span><span class="n">Surface</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="s">'''
        Basic HP bar UI.
        '''</span>
        <span class="n">hp_bar_length</span> <span class="o">=</span> <span class="n">constants</span><span class="p">.</span><span class="n">WINDOW_WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
        
        <span class="c1"># P1
</span>        <span class="n">missing_hp_rect</span> <span class="o">=</span> <span class="n">pg</span><span class="p">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hp_bar_length</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">p1_hp_proportion</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">[</span><span class="s">"P1"</span><span class="p">].</span><span class="n">hp</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">[</span><span class="s">"P1"</span><span class="p">].</span><span class="n">maxHp</span><span class="p">)</span>
        <span class="n">current_hp_rect</span> <span class="o">=</span> <span class="n">pg</span><span class="p">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">missing_hp_rect</span><span class="p">)</span>
        <span class="n">current_hp_rect</span><span class="p">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">hp_bar_length</span> <span class="o">*</span> <span class="n">p1_hp_proportion</span><span class="p">)</span>
        <span class="c1"># For P1, the last bit of HP is the rightmost one
</span>        <span class="n">current_hp_rect</span><span class="p">.</span><span class="n">topright</span> <span class="o">=</span> <span class="n">missing_hp_rect</span><span class="p">.</span><span class="n">topright</span>
        
        <span class="n">pg</span><span class="p">.</span><span class="n">draw</span><span class="p">.</span><span class="n">rect</span><span class="p">(</span><span class="n">display</span><span class="p">,</span> <span class="n">constants</span><span class="p">.</span><span class="n">WHITE</span><span class="p">,</span> <span class="n">missing_hp_rect</span><span class="p">)</span>
        <span class="n">pg</span><span class="p">.</span><span class="n">draw</span><span class="p">.</span><span class="n">rect</span><span class="p">(</span><span class="n">display</span><span class="p">,</span> <span class="n">constants</span><span class="p">.</span><span class="n">RED</span><span class="p">,</span> <span class="n">current_hp_rect</span><span class="p">)</span>
        
        <span class="c1"># P2
</span>        <span class="n">missing_hp_rect</span> <span class="o">=</span> <span class="n">pg</span><span class="p">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hp_bar_length</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">missing_hp_rect</span><span class="p">.</span><span class="n">topright</span> <span class="o">=</span> <span class="p">(</span><span class="n">constants</span><span class="p">.</span><span class="n">WINDOW_WIDTH</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="n">p2_hp_proportion</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">[</span><span class="s">"P2"</span><span class="p">].</span><span class="n">hp</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">characters</span><span class="p">[</span><span class="s">"P2"</span><span class="p">].</span><span class="n">maxHp</span><span class="p">)</span>
        <span class="n">current_hp_rect</span> <span class="o">=</span> <span class="n">pg</span><span class="p">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">missing_hp_rect</span><span class="p">)</span>
        <span class="n">current_hp_rect</span><span class="p">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">hp_bar_length</span> <span class="o">*</span> <span class="n">p2_hp_proportion</span><span class="p">)</span>
        <span class="c1"># For P2, the last bit of HP is the leftmost one (no change required)
</span>        
        <span class="n">pg</span><span class="p">.</span><span class="n">draw</span><span class="p">.</span><span class="n">rect</span><span class="p">(</span><span class="n">display</span><span class="p">,</span> <span class="n">constants</span><span class="p">.</span><span class="n">WHITE</span><span class="p">,</span> <span class="n">missing_hp_rect</span><span class="p">)</span>
        <span class="n">pg</span><span class="p">.</span><span class="n">draw</span><span class="p">.</span><span class="n">rect</span><span class="p">(</span><span class="n">display</span><span class="p">,</span> <span class="n">constants</span><span class="p">.</span><span class="n">BLUE</span><span class="p">,</span> <span class="n">current_hp_rect</span><span class="p">)</span>
</code></pre></div></div>

<p>We don’t have any way to actually lose HP yet, so let’s add a temporary little hack to <code class="language-plaintext highlighter-rouge">Character.walk()</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># gamestate.py
</span>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buttons</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Button</span><span class="p">,</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">facingLeft</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">buttons</span><span class="p">[</span><span class="n">Button</span><span class="p">.</span><span class="n">LEFT</span><span class="p">]:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">forwardWalkspeed</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">backwardWalkspeed</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">hp</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">hp</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1"># TODO: temporarily added to show HP loss
</span>        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">buttons</span><span class="p">[</span><span class="n">Button</span><span class="p">.</span><span class="n">LEFT</span><span class="p">]:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">backwardWalkspeed</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">hp</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">hp</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1"># TODO: temporarily added to show HP loss
</span>            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">xpos</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">forwardWalkspeed</span>
</code></pre></div></div>

<p>Now backwalking causes you to lose HP. A strange game design choice, but for now,
it’s just the thing to help us visualize HP loss.</p>

<p>With our character flipping and UI changes done, our game now looks like this:</p>

<p><img src="/assets/images/article3/walking-and-ui.gif" alt="Walking, flipping, and UI" /></p>

<h2 id="stopping-point">Stopping point</h2>

<p>This article is starting to get a bit long now, so we’ll cut it off here.<br />
We introduced a fair few lofty long-terms goals, but we’ve hardly even started the immediate ones.<br />
We have some basic actions taken based on input, and the skeletons of our game state classes,
but we’ve yet to add an actual attack to our fighting game.<br />
But in article #3.1, we’ll actually implement our first <code class="language-plaintext highlighter-rouge">StateTimeline</code>. Look forward to it.</p>

<p><a href="https://github.com/tuningdipsw/fighting-game-tutorial/tree/article3-game-state-1">Code for this article on GitHub.</a></p>

<p>TODO: edit in link to #3.1<br />
<a href="/fgtutorial/2023/02/01/article3-1-game-state-2.html">» Next: #3.1: Game state 2</a></p>

<h2 id="aside-when-or-when-not-to-flip-a-character">Aside: When or when not to flip a Character</h2>

<p>The common rules for when or when not to flip <code class="language-plaintext highlighter-rouge">Characters</code> are…
I’m literally testing this out as I write this part out, they’re darn complicated.<br />
You might want to boot up a fighting game to test these out yourself instead of just reading it,
it may be a bit tricky to parse through text alone.</p>

<ul>
  <li>
    <p>Characters performing an attack generally don’t change their facing direction.</p>

    <ul>
      <li>This often means that if you do an anti-air attack right before your opponent jumps over you,
and it has a hitbox that’s more in front of your head than above or behind it, the lack of flip might cause it to miss.</li>
    </ul>
  </li>
  <li>
    <p>However, doing a move that passes through the opponent to cross them up
(eg. <a href="http://www.dustloop.com/w/GGACR/Jam_Kuradoberi#Senri_Shinshou">Jam’s crossup 236S~H</a>)
might specifically change your facing direction.</p>
  </li>
  <li>
    <p>Characters midjump do not change their facing direction until they land, jump in midair, or recover from an attack(?).
This has some implications on aerial attacks, like <a href="https://glossary.infil.net/?t=Taco">tacos.</a></p>
  </li>
  <li>
    <p>A character being put in hit/blockstun does not change their facing direction
until they exit stun (return to neutral) or are put in hit/blockstun again.</p>
  </li>
</ul>

<p>However, the check for inputting the correct blocking direction (always the direction <em>away from the opponent</em>)
is done on attack contact and does <strong>not</strong> use facingLeft’s value.
This gives us a further complication when parsing inputs:</p>

<ul>
  <li>
    <p>If you jump over your opponent and do an (eg.) air DP, your character will not flip,
so you <strong>don’t</strong> have to flip your DP input directions.</p>
  </li>
  <li>
    <p>If you jump over your opponent and try to block, it is not parsed as a direct action.<br />
As with a normal jump, your character will not flip,
but you <strong>do</strong> have to block in the away direction if you get hit by an attack, despite your character not flipping.<br />
(Getting hit by an attack will put your character in hit/blockstun and then cause your sprite to flip.)</p>
  </li>
  <li>
    <p>If you were in hit/blockstun and your opponent crosses over you, your character will not flip (immediately),
but you <strong>do</strong> have to flip your blocking direction.</p>
  </li>
  <li>
    <p>There may be <a href="https://glossary.infil.net/?t=Cross-up%20Protection">crossup protection</a> to help you block, though.</p>
  </li>
</ul>

<p>Generally it seems like these rules are a little fast and loose at times - here are some specific examples of quirks between games.</p>

<ul>
  <li>
    <p>In GBVS, pressing the Guard button midjump will flip your character as well.
Blocking with the Guard button will always blocks in the correct direction, so this is sort of a moot point for GBVS.</p>
  </li>
  <li>
    <p>In GG, the input to <a href="https://glossary.infil.net/?t=Faultless%20Defense">FD</a> in midair
(backwards direction and two attack buttons that are not S+H or ?+D) will not be flipped (like the DP input example),
but FDing will not cause you to flip direction.</p>

    <ul>
      <li>
        <p>FD is maintained if you hold down the initial two attack buttons even if you release “back”,
and by remaining in this blocking state you can keep blocking attacks despite not holding a “backwards” direction.</p>
      </li>
      <li>
        <p>After blocking an attack this way, your character will flip because you entered a new state of blockstun,
but again, you will still correctly block even without holding a “back” direction by staying in FD state
(by holding down the two attack buttons).</p>
      </li>
    </ul>
  </li>
  <li>
    <p>MBAACC rules offer the defender some crossup protection by let them block both by holding backwards for their character <em>or</em>
in the same direction that the offensive character is facing.
However, there’s still a trick for the attacker to get around this -
see <a href="https://glossary.infil.net/?t=Sandori">Sandori</a> for more details.</p>
  </li>
</ul>

<p>As you can see, these rules are quite complicated indeed.<br />
A little too complicated for now.<br />
We’ll leave them be for this update, but we will have to account for them in the future.</p>

<hr />

<p>TODO: edit in link to #3.1<br />
<a href="/fgtutorial/2023/02/01/article3-1-game-state-2.html">» Next: #3.1: Game state 2</a></p>


<div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    
    var disqus_config = function () {
    this.page.url = "https://tuningdipsw.github.io/fgtutorial/2023/02/26/article3-game-state-1.html";
	this.page.identifier = "/fgtutorial/2023/02/26/article3-game-state-1.html";
    };
    
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://tuning-2.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  </body>
</html>
